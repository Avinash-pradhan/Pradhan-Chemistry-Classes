{% extends 'base.html' %}

{% block content %}
<div class="card">
    <span class="eyebrow">Student Dashboard</span>
    <h2>Welcome, {{ admission.student.name }}</h2>
    <p class="muted">Admission ID #{{ admission.id }}</p>

    <div class="grid two">
        <div class="card">
            <h3>Academic Details</h3>
            <p><strong>Class:</strong> {{ admission.student_class }}</p>
            <p><strong>Board:</strong> {{ admission.board }}</p>
            <p><strong>Medium:</strong> {{ admission.medium }}</p>
            <p><strong>Batch:</strong> {% if admission.batch %}{{ admission.batch.name }} ({{ admission.batch.timing }}){% else %}Will be assigned by admin{% endif %}</p>
        </div>
        <div class="card">
            <h3>Fee Summary</h3>
            <p><strong>Fee Amount:</strong> &#8377;{{ admission.fee_amount }}</p>
            <p><strong>Fee Paid:</strong> &#8377;{{ admission.fee_paid }}</p>
            <p><strong>Fee Status:</strong> {{ admission.fee_status }}</p>
        </div>
    </div>
</div>

{% if payment %}
    <div class="card" style="margin-top: 20px;">
        <h3>Payment Status</h3>
        <p><strong>Status:</strong>
            {% if payment.status == "Paid" %}
                <span class="badge success">Paid</span>
            {% elif payment.status == "Failed" %}
                <span class="badge danger">Failed</span>
            {% else %}
                <span class="badge warning">Pending</span>
            {% endif %}
        </p>
        {% if payment.payment_id %}
            <p><strong>Payment ID:</strong> {{ payment.payment_id }}</p>
        {% endif %}
        {% if payment.reference_id %}
            <p><strong>Reference:</strong> {{ payment.reference_id }}</p>
        {% endif %}
        {% if payment.status != "Paid" %}
            {% if online_payment_ready %}
                <a class="btn" href="{% url 'start_payment' admission.id %}">Pay Now</a>
                {% if payment_gateway == "PhonePe" %}
                    <a class="btn ghost" href="{% url 'phonepe_status_check' admission.id %}">Check PhonePe Status</a>
                {% endif %}
            {% else %}
                <p class="muted">Online payment is not configured yet. Please pay at the center.</p>
            {% endif %}
        {% endif %}
    </div>
{% endif %}

<div style="margin-top: 16px;">
    <a class="btn" href="{% url 'receipt_pdf' admission.id %}">Download Receipt (PDF)</a>
    <a class="btn outline" href="{% url 'student_logout' %}">Logout</a>
</div>

{% if notices %}
<section class="grid" style="margin-top: 20px;">
    <div class="card">
        <h3>Notices</h3>
        <div class="notice-list">
            {% for notice in notices %}
                <div class="notice-item">
                    <strong>{{ notice.title }}</strong>
                    <p>{{ notice.message }}</p>
                </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}
{% endblock %}
